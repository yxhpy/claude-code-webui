<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>编辑 mcp.json</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <style>
      textarea { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }
    </style>
  </head>
  <body>
    <div class="container py-4">
      <h1 class="mb-3">编辑 Claude Code 配置（路由/MCP）</h1>

      <div class="alert alert-info">
        当前编辑的为 Claude Code 的 MCP 配置（优先项目级 <code>./.claude/mcp.json</code>，否则用户级 <code>~/.claude/mcp.json</code>；可用 <code>CLAUDE_MCP_CONFIG</code> 覆盖）。
        它用于配置 MCP（Model Context Protocol）服务器（命令、参数、资源与环境变量等）。
        请不要把 Claude Code 的 <code>baseurl</code>/<code>apikey</code> 写在这里；它们已通过环境变量
        <code>ANTHROPIC_BASE_URL</code> / <code>ANTHROPIC_AUTH_TOKEN</code> 进行管理。
        如需在 MCP 配置中使用敏感值，请以环境变量占位的形式引用，例如：
        <pre class="mb-0"><code>{
  "mcpServers": {
    "exampleServer": {
      "command": "npx",
      "args": ["-y", "example-mcp-server"],
      "env": {
        "API_KEY": "${ANTHROPIC_AUTH_TOKEN}",
        "BASE_URL": "${ANTHROPIC_BASE_URL}"
      }
    }
  }
}</code></pre>
      </div>

      {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
          <div class="mb-3">
            {% for category, message in messages %}
              <div class="alert alert-{{ category }}" role="alert">{{ message }}</div>
            {% endfor %}
          </div>
        {% endif %}
      {% endwith %}

      <form method="post">
        <div class="mb-3">
          <label class="form-label">mcp.json 内容（路径：<code>{{ mcp_path }}</code>）</label>
          <textarea name="mcp_raw" class="form-control" rows="16" spellcheck="false">{{ mcp_raw }}</textarea>
        </div>
        <div class="d-flex gap-2">
          <button class="btn btn-primary" type="submit">保存</button>
          <a class="btn btn-secondary" href="{{ url_for('index') }}">返回</a>
        </div>
      </form>
    </div>
  </body>
  </html>


